@page "/"
@using GameManager.Components.Pages.components
@using GameManager.Models

<MudLayout Class="@("main-mud-layout")">
    <ActionBar id="main-toolbar" Class="@("main-toolbar")" AddNewGameEvent="AddNewGame" SearchEvent="FilterInfo"></ActionBar>
    <MudGrid>
        @foreach (var info in GameInfos.Where(i => i.Display))
        {
            <Card GameInfo="info" Class="card"></Card>
        }
    </MudGrid>
</MudLayout>

@code {
    private List<GameInfo> GameInfos { get; } = [];


    private void AddNewGame(string exePath)
    {
        var gameInfo = new GameInfo
        {
            GameName = Path.GetFileName(Path.GetDirectoryName(exePath)) ?? "null",
            ExePath = exePath
        };
        GameInfos.Add(gameInfo);
        StateHasChanged();
    }

    private void FilterInfo(string pattern)
    {
        foreach (var info in GameInfos)
        {
            info.Display = info.GameName.Contains(pattern) || string.IsNullOrEmpty(pattern);
        }

        StateHasChanged();
    }

}

<style>
    .main-mud-layout {
        padding: 0px;
    }
    .main-mud-layout > .mud-grid {
        max-width: 100%;
        padding-left: 15px;
    }
    #main-toolbar{
        position: sticky; 
        top: 0;
        margin-bottom: 20px;
        margin-top: 0px;
        z-index: 999;
    }
    .card {
        width: 150px;
        height: 200px;
        margin: 5px;
    }
</style>