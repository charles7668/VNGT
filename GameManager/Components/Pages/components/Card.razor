@inherits MudComponentBase

<MudCard @attributes="UserAttributes!" Style="@Style" Class="@Class">
    <MudCardContent Class="d-flex flex-column">
        <img src="@ImageSrc" loading="lazy" alt="No Image">
        <MudSpacer></MudSpacer>
        <MudText Typo="Typo.caption">@GameInfo?.GameName</MudText>
        <MudToolBar Class="pa-0">
            <MudButton StartIcon="@Icons.Material.Filled.ArrowRight">Run</MudButton>
            <MudSpacer></MudSpacer>
            <MudMenu Icon="@Icons.Material.Filled.MoreVert">
                <MudMenuItem OnClick="OnEdit">Edit</MudMenuItem>
            </MudMenu>
        </MudToolBar>
    </MudCardContent>
</MudCard>

@code
{
    [Inject]
    private IDialogService? DialogService { get; set; }

    [Parameter]
    public GameInfo? GameInfo { get; set; }

    [Parameter]
    public string? Width { get; set; }

    [Parameter]
    public string? Height { get; set; }

    private string ImageSrc
    {
        get
        {
            if (GameInfo == null || string.IsNullOrEmpty(GameInfo.CoverPath))
                return "";
            return "data:image/png;base64, " + Convert.ToBase64String(File.ReadAllBytes(GameInfo.CoverPath));
        }
    }

    private async Task OnEdit()
    {
        if (GameInfo == null || DialogService == null)
            return;
        var inputModel = new DialogGameInfoEdit.FormModel();
        DataMapService.Map(GameInfo, inputModel);
        var parameters = new DialogParameters<DialogGameInfoEdit>
        {
            { x => x.Model, inputModel }
        };
        var dialogReference = await DialogService.ShowAsync<DialogGameInfoEdit>("Edit Game Info", parameters, new DialogOptions
        {
            BackdropClick = false
        });
        var dialogResult = await dialogReference.Result;
        if (dialogResult.Canceled)
            return;
        if (dialogResult.Data is not DialogGameInfoEdit.FormModel resultModel)
            return;
        DataMapService.Map(resultModel, GameInfo);
        StateHasChanged();
    }
}

<style>
    .mud-card {
        width: @Width;
        height: @Height;
        overflow: hidden;
        max-height: 100%;
    }
    .mud-card .mud-card-content {
        height: 100%;
        max-height: 100%;
    }
    .mud-card .mud-card-content img {
        max-height: 80%;
        object-fit: cover;
    }
    .mud-card .mud-card-content .mud-text {
        height: 50px;
    }
</style>